from enum import Enum
from typing import Optional

from pydantic import BaseModel


class SourceEnum(str, Enum):
    MITRE_ICS = "MITRE_ICS"
    SWAT_DOC = "SWaT_DOC"


class DocTypeEnum(str, Enum):
    ATTACK_TECHNIQUE = "attack_technique"
    COMPONENT = "component"
    PID = "pid"
    STAGE = "stage"


class TechniqueEnum(str, Enum):
    T0800 = "T0800"
    T0801 = "T0801"
    T0802 = "T0802"
    T0803 = "T0803"
    T0804 = "T0804"
    T0805 = "T0805"
    T0806 = "T0806"
    T0807 = "T0807"
    T0809 = "T0809"
    T0811 = "T0811"
    T0812 = "T0812"
    T0813 = "T0813"
    T0814 = "T0814"
    T0815 = "T0815"
    T0816 = "T0816"
    T0817 = "T0817"
    T0819 = "T0819"
    T0820 = "T0820"
    T0821 = "T0821"
    T0822 = "T0822"
    T0823 = "T0823"
    T0826 = "T0826"
    T0827 = "T0827"
    T0828 = "T0828"
    T0829 = "T0829"
    T0830 = "T0830"
    T0831 = "T0831"
    T0832 = "T0832"
    T0834 = "T0834"
    T0835 = "T0835"
    T0836 = "T0836"
    T0837 = "T0837"
    T0838 = "T0838"
    T0839 = "T0839"
    T0840 = "T0840"
    T0842 = "T0842"
    T0843 = "T0843"
    T0845 = "T0845"
    T0846 = "T0846"
    T0847 = "T0847"
    T0848 = "T0848"
    T0849 = "T0849"
    T0851 = "T0851"
    T0852 = "T0852"
    T0853 = "T0853"
    T0855 = "T0855"
    T0856 = "T0856"
    T0857 = "T0857"
    T0858 = "T0858"
    T0859 = "T0859"
    T0860 = "T0860"
    T0861 = "T0861"
    T0862 = "T0862"
    T0863 = "T0863"
    T0864 = "T0864"
    T0865 = "T0865"
    T0866 = "T0866"
    T0867 = "T0867"
    T0868 = "T0868"
    T0869 = "T0869"
    T0871 = "T0871"
    T0872 = "T0872"
    T0873 = "T0873"
    T0874 = "T0874"
    T0877 = "T0877"
    T0878 = "T0878"
    T0879 = "T0879"
    T0880 = "T0880"
    T0881 = "T0881"
    T0882 = "T0882"
    T0883 = "T0883"
    T0884 = "T0884"
    T0885 = "T0885"
    T0886 = "T0886"
    T0887 = "T0887"
    T0888 = "T0888"
    T0889 = "T0889"
    T0890 = "T0890"
    T0891 = "T0891"
    T0892 = "T0892"
    T0893 = "T0893"
    T0894 = "T0894"
    T0895 = "T0895"


class ComponentEnum(str, Enum):
    T101 = "T101"
    P101 = "P101"
    P102 = "P102"
    LIT101 = "LIT101"
    FIT101 = "FIT101"
    MV101 = "MV101"
    P201 = "P201"
    P202 = "P202"
    P203 = "P203"
    P204 = "P204"
    P205 = "P205"
    P206 = "P206"
    P207 = "P207"
    P208 = "P208"
    FIT201 = "FIT201"
    AIT201 = "AIT201"
    AIT202 = "AIT202"
    AIT203 = "AIT203"
    LS201 = "LS201"
    LS202 = "LS202"
    LS203 = "LS203"
    MV201 = "MV201"
    T301 = "T301"
    P301 = "P301"
    P302 = "P302"
    LIT301 = "LIT301"
    FIT301 = "FIT301"
    FI301 = "FI301"
    PSH301 = "PSH301"
    DPSH301 = "DPSH301"
    DPIT301 = "DPIT301"
    MV301 = "MV301"
    MV302 = "MV302"
    MV303 = "MV303"
    MV304 = "MV304"
    T401 = "T401"
    P401 = "P401"
    P402 = "P402"
    P403 = "P403"
    P404 = "P404"
    UV401 = "UV401"
    LIT401 = "LIT401"
    AIT401 = "AIT401"
    AIT402 = "AIT402"
    FIT401 = "FIT401"
    AIT501 = "AIT501"
    AIT502 = "AIT502"
    PSL501 = "PSL501"
    PSH501 = "PSH501"
    PIT501 = "PIT501"
    PIT502 = "PIT502"
    PIT503 = "PIT503"
    P501 = "P501"
    P502 = "P502"
    P505 = "P505"
    FIT501 = "FIT501"
    FIT502 = "FIT502"
    FIT503 = "FIT503"
    FIT504 = "FIT504"
    AIT503 = "AIT503"
    AIT504 = "AIT504"
    RO501 = "RO501"
    RO502 = "RO502"
    RO503 = "RO503"
    MV501 = "MV501"
    MV502 = "MV502"
    T601 = "T601"
    T602 = "T602"
    T603 = "T603"
    P601 = "P601"
    P602 = "P602"
    P603 = "P603"
    LS601 = "LS601"
    LS602 = "LS602"
    LS603 = "LS603"
    FIT601 = "FIT601"
    FI601 = "FI601"
    FI602 = "FI602"


class StageEnum(str, Enum):
    STAGE_1 = "P1"
    STAGE_2 = "P2"
    STAGE_3 = "P3"
    STAGE_4 = "P4"
    STAGE_5 = "P5"
    STAGE_6 = "P6"


class TacticEnum(str, Enum):
    INITIAL_ACCESS = "Initial Access"
    EXECUTION = "Execution"
    PERSISTENCE = "Persistence"
    PRIVILEGE_ESCALATION = "Privilege Escalation"
    EVASION = "Evasion"
    DISCOVERY = "Discovery"
    LATERAL_MOVEMENT = "Lateral Movement"
    COLLECTION = "Collection"
    COMMAND_AND_CONTROL = "Command and Control"
    INHIBIT_RESPONSE_FUNCTION = "Inhibit Response Function"
    IMPAIR_PROCESS_CONTROL = "Impair Process Control"
    IMPACT = "Impact"


class Metadata(BaseModel):
    source: SourceEnum
    doc_type: DocTypeEnum
    technique_id: Optional[str] = None
    tactic: Optional[TacticEnum] = None
    component_id: Optional[ComponentEnum] = None
    stage_id: Optional[StageEnum] = None


class Document(BaseModel):
    id: str
    text: str
    metadata: Metadata
